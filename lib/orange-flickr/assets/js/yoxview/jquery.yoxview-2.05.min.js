var yoxviewApi;
(function(x){var F;x.yoxviewUnload=function(){if(yoxviewApi){yoxviewApi.unload();yoxviewApi=null}};x(window).unload(function(){x.yoxviewUnload()});x.fn.extend({yoxview:function(Z){if(this.length==0)return this;var U=this;F||(F=typeof _yoxviewPath!="undefined"?_yoxviewPath:Yox.getPath(/(.*)jquery.yoxview.*/i));this.loadSkin=function(s,G){var w=s.skin;if(!yoxviewSkins[w]){var H=F+"skins/"+w+"/yoxview."+w;x.ajax({url:H+".js",dataType:"script",success:function(la){eval(la);x.extend(s,yoxviewSkins[w].options);yoxviewSkins[w].css!==
false&&Yox.addStylesheet(parent.document,H+".css");U.loadLanguage(s,G)},error:function(){alert("Error loading skin file "+H+".js")}})}};this.loadLanguage=function(s,G){var w=s.lang;if(yoxviewLanguages[w])Yox.loadDataSource(s,G,U);else{yoxviewLanguages[w]={};x.ajax({url:F+"lang/"+w+".js",async:false,dataType:"json",success:function(H){yoxviewLanguages[w]=H;Yox.loadDataSource(s,G,U)}})}};var xa={autoHideInfo:true,autoPlay:false,backgroundColor:"#000000",backgroundOpacity:0.8,buttonsFadeTime:300,cacheBuffer:5,
cacheImagesInBackground:true,controlsInitialFadeTime:1500,controlsInitialDisplayTime:1E3,dataFolder:F+"data/",defaultDimensions:{flash:{width:720,height:560},iframe:{width:1024}},flashVideoPlayer:"jwplayer",imagesFolder:F+"images/",infoBackColor:"#000000",infoBackOpacity:0.5,isRTL:false,lang:"en",langFolder:F+"lang/",loopPlay:true,parentElement:x(parent.document.body),playDelay:3E3,popupMargin:20,popupResizeTime:600,renderButtons:true,renderMenu:true,showBarsOnOpen:true,showButtonsOnOpen:true,titleAttribute:"title",
titleDisplayDuration:2E3},N=x.extend(true,xa,Z);(N.skin?this.loadSkin:this.loadLanguage).apply(this,[N,function(s){if(yoxviewApi)yoxviewApi.AddViews(s,N);else yoxviewApi=new YoxView(s,N)}]);return this}})})(jQuery);var yoxviewLanguages=[],yoxviewSkins=[];
function YoxView(x,F){function Z(a){a=e(a).data("yoxview");if(!y||ya!=a.viewIndex){if(!a.cacheVars)a.cacheVars={cachedImagesCount:0,cacheDirectionForward:true,cacheBufferLastIndex:null,currentCacheImg:0};y=a.images;m=y.length;ya=a.viewIndex;l=a.cacheVars;var b=false;if(a.options&&!Yox.compare(c,a.options)){c=a.options;b=true}else if(!a.options&&!Yox.compare(c,za)){c=za;b=true}else if(V&&m==1||j&&!V&&m>0)b=true;if(b){if(j){t.remove();O=W=$=P=ma=V=j=undefined;z=0;l={};g.infoButtons={}}Aa()}}}function U(a,
b){var d=b.queryFields&&(b.queryFields.width||b.queryFields.height)?{width:parseInt(b.queryFields.width),height:parseInt(b.queryFields.height)}:c.defaultDimensions[a];if(isNaN(d.width))d.width=null;if(isNaN(d.height))d.height=null;if(b.queryFields){b.queryFields.width=undefined;b.queryFields.height=undefined}return d}function xa(a,b,d){a=e(a);a.data("yoxview",{viewIndex:b,cacheVars:{cachedImagesCount:0,cacheDirectionForward:true,cacheBufferLastIndex:null,currentCacheImg:0}});d.allowedImageUrls=[Yox.Regex.image];
if(d.allowedUrls)d.allowedImageUrls=d.allowedImageUrls.concat(d.allowedUrls);if(!Yox.compare(c,d))a.data("yoxview").options=d;d.isSingleLink=a[0].tagName=="A";var f=[],i=0;(d.isSingleLink?a:a.find("a:has(img)")).each(function(h,I){var r=e(I),n;n={};var L=r.attr("href"),Q=r.children("img:first");n={};for(supportedType in Ma){var aa=Ma[supportedType](r,L,Q,d);if(aa){e.extend(aa,{contentType:supportedType,elementId:Ya++});n.media=aa;break}}if(n.media){n.thumbnailImg=Q;n=n}else n=null;if(n!=null){f.push(n);
if(d.isSingleLink)r.data("yoxview").imageIndex=i;else r.data("yoxview",{imageIndex:i});i++}});if(d.images)f=f.concat(d.images);if(d.dataSource)Yox.dataSources[d.dataSource].getImagesData(d,function(h){f=f.concat(h.images);a.data("yoxview").images=f;var I=h.isGroup?[e.extend(h,{media:{title:h.title+" ("+h.images.length+" images)",alt:h.title}})]:h.images;N(a,d.isSingleLink?null:I,!h.createGroups?null:function(r){var n=e(r.currentTarget).data("yoxview"),L=e(r.currentTarget);r=L.data("yoxthumbs");if(n.imagesAreSet)g.openGallery(n.viewIndex);
else{L.css("cursor","wait");var Q=e.extend({},c);if(Q.dataSourceOptions)e.extend(Q.dataSourceOptions,r);else Q.dataSourceOptions=r;Yox.dataSources[c.dataSource].getImagesData(Q,function(aa){n.images=aa.images;n.imagesAreSet=true;L.css("cursor","");g.openGallery(n.viewIndex)})}});h.createGroups?e.each(a.yoxthumbs("thumbnails"),function(r,n){n.data("yoxview",{viewIndex:R.length});R.push(n)}):e.each(a.yoxthumbs("thumbnails"),function(r,n){var L=i+r;f[L].thumbnailImg=n.children("img").eq(0);n.data("yoxview",
{imageIndex:L})});if(!g.firstViewWithImages&&h.images.length>0){g.firstViewWithImages=a;d.cacheImagesInBackground&&g.startCache()}});else{a.data("yoxview").images=f;N(a)}}function N(a,b,d){var f=function(i){var h=e(i.currentTarget).data("yoxview");if(!h||h.imageIndex===null)return true;else{i.preventDefault();g.openGallery(e(i.liveFired||i.currentTarget).data("yoxview").viewIndex,h.imageIndex)}};if(a[0].tagName=="A")a.bind("click.yoxview",f);else b?a.yoxthumbs({images:b,enableOnlyMedia:false,onClick:d||
function(i){i.preventDefault();c.thumbnailsOptions&&c.thumbnailsOptions.onClick?c.thumbnailsOptions.onClick(e(i.currentTarget).data("yoxview").imageIndex,e(i.currentTarget),e(i.liveFired).data("yoxview").viewIndex):g.openGallery(e(i.liveFired||i.currentTarget).data("yoxview").viewIndex,e(i.currentTarget).data("yoxview").imageIndex);return false}}):a.delegate("a:has(img)","click.yoxview",f)}function s(a){var b=e(R[ya]);C=b[0].tagName=="A"?b:y[z].thumbnailImg;if(!C||C.length==0)C=y[0].thumbnailImg;
if(C){a&&P&&P.attr("src",C.attr("src"));Ba=C.offset();u={width:C.width(),height:C.height(),top:Ba.top-e(window).scrollTop(),left:Ba.left}}}function G(a){na.css("background-position",J.getBackgroundPosition("notifications",a));na.stop().fadeIn(c.buttonsFadeTime,function(){e(this).delay(500).fadeOut(c.buttonsFadeTime)})}function w(a){e(a).stop().animate({opacity:0.5},c.buttonsFadeTime)}function H(a,b,d){var f=e("<a>",{href:"#",click:function(){return g.clickBtn(g[b],d)}});e("<span>"+a+"</span>").css("opacity",
"0").appendTo(f);f.append(J.getSprite("icons",b));return f}function la(a,b,d){var f=new Image;f.src=c.imagesFolder+b+".png";f=e("<a>",{css:{background:"url("+f.src+") no-repeat "+b+" center",opacity:"0",outline:"0"},className:"yoxview_ctlBtn",href:"#"});f.css(b,"0");if(d)f.css("cursor","default");else{f.click(function(){this.blur();return g.clickBtn(a,true)});c.buttonsFadeTime!=0&&f.hover(function(){g.isOpen&&e(this).stop().animate({opacity:0.6},c.buttonsFadeTime)},function(){e(this).stop().animate({opacity:0},
c.buttonsFadeTime)})}return f}function Za(){var a=typeof c.popupMargin=="number"?[String(c.popupMargin)]:c.popupMargin.split(" ",4);k.top=parseInt(a[0]);if(a.length==1)k.bottom=k.right=k.left=k.top;else if(a.length==2){k.bottom=k.top;k.right=k.left=parseInt(a[1])}else if(a.length==3){k.bottom=parseInt(a[2]);k.right=k.left=parseInt(a[1])}else if(a.length==4){k.right=parseInt(a[1]);k.bottom=parseInt(a[2]);k.left=parseInt(a[3])}k.totalHeight=k.top+k.bottom;k.totalWidth=k.left+k.right}function Aa(){Za();
D=Na();o=yoxviewLanguages[c.lang];var a=c.skin?yoxviewSkins[c.skin]:null;j=e("<div>",{id:"yoxview",click:function(h){h.stopPropagation()}});t=e("<div>",{id:"yoxview_popupWrap",click:function(h){h.preventDefault();g.clickBtn(g.close,true)}});c.skin&&t.attr("className","yoxview_"+c.skin);if(c.backgroundOpacity===0)t.css("background","none");else Yox.Support.rgba()&&t.css("background-color",Yox.hex2rgba(c.backgroundColor,c.backgroundOpacity));t.appendTo(c.parentElement).append(j);W=e("<div>",{className:"yoxview_imgPanel",
css:{"z-index":"2"}});O=e("<div>",{className:"yoxview_imgPanel",css:{"z-index":"1",display:"none"}});P=e("<img />",{className:"yoxview_fadeImg",css:{display:"block",width:"100%",height:"100%"}});$=e("<img />",{className:"yoxview_fadeImg",css:{display:"block",width:"100%",height:"100%"}});W.data("yoxviewPanel",{image:P}).append(P).appendTo(j);O.data("yoxviewPanel",{image:$});O.append($).appendTo(j);var b=m==1;if(b&&!y[0].media.title)c.renderInfo=false;if(c.renderMenu!==false){var d=e("<div>",{className:"yoxview_popupBarPanel yoxview_top"});
c.autoHideMenu!==false&&d.hover(function(){g.isOpen&&Oa()},function(){g.isOpen&&Ca()});A=e("<div>",{id:"yoxview_menuPanel"});if(Yox.Support.rgba()&&c.menuBackgroundColor)A.css("background",Yox.hex2rgba(c.menuBackgroundColor,c.menuBackgroundOpacity||0.8));var f=H(o.Help,"help",false);g.infoButtons.playBtn=H(o.Slideshow,"play",false);ba=g.infoButtons.playBtn.children("span");A.append(H(o.Close,"close",true),f,g.infoButtons.playBtn);if(b){g.infoButtons.playBtn.css("display","none");f.css("display","none");
A.css({width:58})}A.find("a:last-child").attr("class","last");d.append(A).appendTo(j);A.delegate("a","mouseenter",function(){e(this).stop().animate({top:"8px"},"fast").find("span").stop().animate({opacity:1},"fast")}).delegate("a","mouseleave",function(){e(this).stop().animate({top:"0"},"fast").find("span").stop().animate({opacity:0},"fast")})}if(c.renderButtons!==false&&(!b||!e.support.opacity)){V=la(g.prev,c.isRTL?"right":"left",b);ma=la(g.next,c.isRTL?"left":"right",b);j.append(V,ma);S=b&&!e.support.opacity?
e():j.find(".yoxview_ctlBtn")}else S=e();ca=e("<div>",{id:"yoxview_ajaxLoader",className:"yoxview_notification",css:{display:"none"}});ca.append(e("<img>",{src:c.imagesFolder+"popup_ajax_loader.gif",alt:o.Loading,css:{width:32,height:32,"background-image":"url("+c.imagesFolder+"sprites.png)","background-position":J.getBackgroundPosition("notifications","empty")}})).appendTo(j);if(!c.disableNotifications){na=e("<img>",{className:"yoxview_notification"});j.append(na)}T=e("<div>",{id:"yoxview_helpPanel",
href:"#",title:o.CloseHelp,css:{background:"url("+c.imagesFolder+"help_panel.png) no-repeat center top",direction:o.Direction,opacity:"0"},click:function(){return g.clickBtn(g.help,false)}});d=document.createElement("h1");d.innerHTML=o.Help.toUpperCase();f=document.createElement("p");f.innerHTML=o.HelpText;var i=document.createElement("span");i.id="yoxview_closeHelp";i.innerHTML=o.CloseHelp;T.append(d).append(f).append(i).appendTo(j);if(c.renderInfo!==false){p=e("<div>",{id:"yoxview_infoPanel",click:function(h){h.stopPropagation()}});
if(c.infoBackOpacity===0){p.css("background","none");K=p}else if(Yox.Support.rgba()){K=p;p.css("background-color",Yox.hex2rgba(c.infoBackColor,c.infoBackOpacity))}else{p.append(e("<div>",{id:"yoxview_infoPanelBack",css:{background:c.infoBackColor,opacity:c.infoBackOpacity}}));K=e("<div>",{id:"yoxview_infoPanelContent"})}oa=e("<span>",{id:"yoxview_count"});X=e("<div>",{id:"yoxview_infoText"});if(b){X.css("margin-left","10px");oa.css("display","none")}K.append(oa);if(c.renderInfoPin!==false){Da=J.getSprite("icons",
c.autoHideInfo?"pin":"unpin");Pa=e("<a>",{className:"yoxviewInfoLink",href:"#",title:c.autoHideInfo?o.PinInfo:o.UnpinInfo,css:{display:"inline"},click:function(h){h.preventDefault();c.autoHideInfo=!c.autoHideInfo;Da.css("background-position",J.getBackgroundPosition("icons",c.autoHideInfo?"pin":"unpin"));this.title=c.autoHideInfo?o.PinInfo:o.UnpinInfo}});Pa.append(Da).appendTo(K)}if(a&&a.infoButtons){a=a.infoButtons(c,o,J,t,j);if(c.infoButtons)e.extend(c.infoButtons,a);else c.infoButtons=a}if(c.infoButtons){e.extend(g.infoButtons,
c.infoButtons);for(infoButton in c.infoButtons)c.infoButtons[infoButton].attr("className","yoxviewInfoLink").css("display","block").appendTo(K)}if(c.linkToOriginalContext!==false){da=e("<a>",{className:"yoxviewInfoLink",target:"_blank",title:o.OriginalContext});da.append(J.getSprite("icons","link")).appendTo(K)}K.append(X);Yox.Support.rgba()||p.append(K);p.appendTo(c.renderInfoExternally?t:j);if(!c.renderInfoExternally){M=e("<div>",{className:"yoxview_popupBarPanel yoxview_bottom"});M.hover(function(){g.isOpen&&
!ea&&c.autoHideInfo!==false&&pa()},function(){g.isOpen&&!ea&&c.autoHideInfo!==false&&fa()});p.wrap(M);M=p.parent()}}Yox.Support.rgba()||($a=e("<div>",{css:{position:"fixed",height:"100%",width:"100%",top:"0",left:"0",background:c.backgroundColor,"z-index":"1",opacity:c.backgroundOpacity}}).appendTo(t))}function Ea(){l.cachedImagesCount++;if(l.cachedImagesCount==m)l.cacheComplete=true;l.cacheComplete||Qa()}function Qa(){if(!c.cacheBuffer||l.currentCacheImg!=l.cacheBufferLastIndex)ga(l.currentCacheImg+
(l.cacheDirectionForward?1:-1))}function Fa(){if(c.cacheBuffer){l.cacheBufferLastIndex=l.cacheDirectionForward?z+c.cacheBuffer:z-c.cacheBuffer;if(l.cacheBufferLastIndex<0)l.cacheBufferLastIndex+=m;else if(l.cacheBufferLastIndex>=m)l.cacheBufferLastIndex-=m}}function ga(a){if(!l.cacheComplete){if(a==m)a=0;else if(a<0)a+=m;var b=y[a].media;l.currentCacheImg=a;if(b&&!b.loaded)if(b.contentType==="image"||!b.contentType)Ra.src=b.src;else Sa(b,function(){Ea()});else Qa()}}function Ta(){Ga=true;clearTimeout(Ha);
ca.stop();Ha=setTimeout(function(){ca.css("opacity","0.6").fadeIn(c.buttonsFadeTime)},c.buttonsFadeTime)}function Ia(a,b,d,f,i){j.stop().animate({width:a,height:b,top:d,left:f},c.popupResizeTime,i)}function qa(){if(m!=1){q=true;if(ba)ba.text(o.Pause);else g.infoButtons.playBtn&&g.infoButtons.playBtn.attr("title",o.Pause);g.infoButtons.playBtn&&g.infoButtons.playBtn.find("img").css("background-position",J.getBackgroundPosition("icons","pause"));if(z<m-1)Ja=setTimeout(function(){g.next(true)},c.playDelay);
else if(c.loopPlay)Ja=setTimeout(function(){g.select(0,null)},c.playDelay);else E()}}function E(){clearTimeout(Ja);q=false;if(ba)ba.text(o.Play);else g.infoButtons.playBtn&&g.infoButtons.playBtn.attr("title",o.Play);g.infoButtons.playBtn&&g.infoButtons.playBtn.find("img").css("background-position",J.getBackgroundPosition("icons","play"))}function Na(){var a=e(parent.window).width(),b=e(parent.window).height();return{height:b,width:a,usableHeight:b-k.totalHeight,usableWidth:a-k.totalWidth}}function Ua(a){a=
a.width&&a.height?Yox.fitImageSize(a,{width:D.usableWidth,height:D.usableHeight}):{width:a.width?Math.min(a.width,D.usableWidth):D.usableWidth,height:a.height?Math.min(a.height,D.usableHeight):D.usableHeight};a.top=k.top+Math.round((D.usableHeight-a.height)/2);a.left=k.left+Math.round((D.usableWidth-a.width)/2);return a}function pa(a){clearTimeout(ha);var b=X.outerHeight();if(b<Va)b=Va;p.stop().animate({height:b},500,function(){a&&a()})}function fa(a){clearTimeout(ha);p.stop().animate({height:0},
500,function(){a&&a()})}function Ca(a){if(A){clearTimeout(Ka);A.stop().animate({top:ab},500,function(){a&&a()})}}function Oa(a){if(A){clearTimeout(Ka);A.stop().animate({top:0},500,function(){a&&a()})}}function Wa(){ia=v;v=ra?O:W;ra=!ra}function sa(a){var b=a.contentType==="image"||!a.contentType;b&&ea&&M&&M.css("display","block");clearTimeout(ha);Wa();var d=v.data("yoxviewPanel");B.width=a.width;B.height=a.height;B.padding=a.padding;if(p){var f=a.title||"";if(a.description)f+=f!=""?"<div id='yoxview_infoTextDescription'>"+
a.description+"</div>":a.description;X.html(f);m>1&&oa.html(z+1+"/"+m);if(da)g.currentImage.link?da.attr("href",g.currentImage.link).css("display","inline"):da.css("display","none")}f=Ua(a);if(b){currentImageElement=ra?P:$;currentImageElement.attr({src:a.src,title:a.title,alt:a.alt});d.image=currentImageElement;if(!d.isImage&&d.element){d.element.css("display","none");d.image.css("display","block");d.isImage=true}if(!ja){c.renderButtons&&S.css({height:"100%",width:"50%",top:"0"});ea=false;ja=true}}else{if(d.element&&
d.elementId!=a.elementId){d.element.remove();d.element=undefined}if(!d.element)if(a.html){d.element=e("<div>",{className:bb});j.append(d.element)}else{j.append(a.element);d.element=a.element}a.html&&d.element.html(a.html);v=d.element;if(ja){if(M){c.autoHideInfo!==false&&fa();M.css("display","none");ea=true}c.renderButtons&&S.css({width:ta.width,height:ta.height});ja=false}c.renderButtons&&S.css({top:(f.height-ta.height)/2});if(d.isImage===undefined||d.isImage){d.element.css("display","block");d.image.css("display",
"none");d.isImage=false}}ua?v.animate({width:f.width,height:f.height},c.popupResizeTime):v.css({width:f.width,height:f.height});if(Ga){Ga=false;clearTimeout(Ha);ca.stop().fadeOut(c.buttonsFadeTime)}Y=true;Ia(f.width,f.height,f.top,f.left,function(){if(ua){g.isOpen=true;if(c.controlsInitialDisplayTime>0){c.showButtonsOnOpen&&S.animate({opacity:0.5},c.controlsInitialFadeTime,function(){c.buttonsFadeTime!=0&&e(this).delay(c.controlsInitialDisplayTime).animate({opacity:0},c.controlsInitialFadeTime)});
if(c.showBarsOnOpen){Oa(function(){if(c.autoHideMenu!==false)Ka=setTimeout(function(){Ca()},c.controlsInitialDisplayTime)});p&&pa(function(){if(c.autoHideInfo!==false)ha=setTimeout(function(){fa()},c.controlsInitialDisplayTime)})}}c.autoPlay&&g.play();c.onOpen&&c.onOpen();if(va){va();va=undefined}ua=false}if(B.padding){var i=j.width(),h=j.height();if(B.padding){i-=B.padding.horizontal;h-=B.padding.vertical}v.css({width:i+"px",height:h+"px"})}Y=false});v.css({"z-index":"2",opacity:1});ia&&ia.css("z-index",
"1");v.fadeIn(c.popupResizeTime,function(){ia&&ia.css("display","none");p&&pa(function(){if(c.autoHideInfo!==false)ha=setTimeout(function(){fa()},c.titleDisplayDuration)});if(m>1){if(c.cacheImagesInBackground&&!l.cacheComplete)ga(z+(l.cacheDirectionForward?1:-1));q&&qa()}})}function cb(a,b,d,f,i){jQuery.jsonp({url:db[a]||"http://oohembed.com/oohembed/",data:jQuery.extend({url:b,format:"json"},d),dataType:"jsonp",callbackParameter:"callback",success:function(h){var I={title:h.title,width:h.width,height:h.height,
type:h.type};if(h.type==="video")I.html=h.html.replace(/<embed /,'<embed wmode="transparent" ').replace(/<param/,'<param name="wmode" value="transparent"><param').replace(/width=\"[\d]+\"/ig,'width="100%"').replace(/height=\"[\d]+\"/ig,'height="100%"');else h.type==="photo"&&jQuery.extend(I,{src:h.url,alt:h.title,type:"image"});f(I)},error:function(h,I){i&&i(h,I)}})}function Xa(a){try{if(!a)throw"Error: Media is unavailable.";if(a.contentType==="image"||!a.contentType){if(e.support.opacity)La.src=
"";La.src=a.src}else!a.loaded&&a.contentType=="ooembed"?Sa(a,function(d){sa(d)},function(d){wa("Error getting data from:<br /><span class='errorUrl'>"+d.data.url+"</span>")}):sa(g.currentImage.media)}catch(b){wa(b)}}function Sa(a,b,d){a.contentType=="ooembed"&&cb(a.provider,a.url,c.videoSize,function(f){e.extend(a,f,{loaded:true});b&&b(a)},d)}function wa(a){sa({html:"<span class='yoxview_error'>"+a+"</span>",width:500,height:300,type:"error",title:""})}var g=this,e=jQuery,ca,l={},Ra=new Image,oa,
S,Ya=0,z=0,o={},B={},ya=0,za=F,ea=false,eb={wmode:"transparent",width:"100%",height:"100%",allowfullscreen:"true",allowscriptaccess:"true",hasVersion:9},ua=true,T,ha,Ka,P,$,y,m=0;this.infoButtons={};var p,K,da,Va=30,M,Pa,Da,X,ra=this.isOpen=false,ja=true,q=false,Y=false,Ha,Ga=false,ta={width:100,height:100},bb="yoxview_mediaPanel",db={vimeo:"http://vimeo.com/api/oembed.json",myspace:"http://vids.myspace.com/index.cfm?fuseaction=oembed"},ab=-42,A,ma,na,va,c=za,W,O,ba,j,$a,k={},Ja,t,V,ka=false,La=new Image,
C,Ba,u,R=[],D,fb={40:"DOWN",35:"END",13:"ENTER",36:"HOME",37:"LEFT",39:"RIGHT",32:"SPACE",38:"UP",72:"h",27:"ESCAPE"},gb={RIGHT:c.isRTL?"prev":"next",DOWN:"next",UP:"prev",LEFT:c.isRTL?"next":"prev",ENTER:"play",HOME:"first",END:"last",SPACE:"next",h:"help",ESCAPE:"close"},J=new Yox.Sprites({notifications:{width:59,height:59,sprites:["empty","playRTL","play","pause","last","first"]},icons:{width:18,height:18,sprites:["close","help","playpause","link","pin","unpin","play","pause","right","left"]},
menu:{height:42,sprites:["back"]}},c.imagesFolder+"sprites.png",c.imagesFolder+"empty.gif");this.AddViews=function(a,b){var d=this.firstViewWithImages!=undefined;jQuery.each(a,function(){xa(this,R.length,b);R.push(this);if(!g.firstViewWithImages){var f=e(this).data("yoxview").images;if(f&&f.length!=0)g.firstViewWithImages=this}});if(!d&&this.firstViewWithImages){Z(this.firstViewWithImages);Aa();if(b.cacheImagesInBackground&&m!=0){Fa();ga(0)}d=true}};this.SetImages=function(a){m=a.length};var Ma={image:function(a,
b,d,f){for(var i=null,h=0;h<f.allowedImageUrls.length&&!i;h++)if(b.match(f.allowedImageUrls[h]))i={src:a.attr("href"),title:d.attr(f.titleAttribute),alt:d.attr("alt")};return i},flash:function(a,b,d,f){var i=null;var h=(a=b.match(Yox.Regex.flash))?null:b.match(Yox.Regex.flashvideo);if(a||h){b=Yox.getUrlData(b);i=e("<div>",{className:"yoxview_element",html:"<div class='yoxview_error'>Please install the latest version of the <a href='http://www.adobe.com/go/getflashplayer' target='_blank'>Flash player</a> to view content</div>"});
h=h?Yox.flashVideoPlayers[f.flashVideoPlayer](f.flashVideoPlayerPath,b.path,b.queryFields&&b.queryFields.image?b.queryFields.image:d.attr("src"),d.attr(f.titleAttribute)):b.queryFields||{};if(a)h.swf=b.path;e.extend(h,eb);i.flash(h);i={element:i,title:d.attr(f.titleAttribute)};e.extend(i,U("flash",b))}return i},ooembed:function(a,b){var d=null;for(videoProvider in Yox.Regex.video)if(b.match(Yox.Regex.video[videoProvider])){d={provider:videoProvider,url:b};break}return d},inline:function(a,b,d,f){if(!f.allowInternalLinks)return null;
a=null;if((b=Yox.getUrlData(b))&&b.anchor){b=e("#"+b.anchor);if(b.length!=0){d={width:parseInt(b.css("width")),height:parseInt(b.css("height"))};b.css({position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"block"});a={type:"inlineElement",element:b,title:b.attr("title")};f={horizontal:parseInt(b.css("padding-right"))+parseInt(b.css("padding-left")),vertical:parseInt(b.css("padding-top"))+parseInt(b.css("padding-bottom"))};d.width=isNaN(d.width)?null:d.width+f.horizontal;d.height=isNaN(d.height)?
null:d.height+f.vertical;e.extend(a,d);if(f.horizontal!=0||f.vertical!=0)a.padding=f;b.remove()}}return a},iframe:function(a,b,d){var f=null;if((a=a.attr("target"))&&a=="yoxview")if((b=Yox.getUrlData(b))&&b.path){a=U("iframe",b);if(b.queryFields){b.queryFields.width=undefined;b.queryFields.height=undefined}f={element:e("<iframe>",{src:Yox.urlDataToPath(b),className:"yoxview_element"}),title:d.attr("title"),frameborder:"0"};e.extend(f,a)}return f}};this.openGallery=function(a,b,d){if(typeof a=="function"){d=
a;a=b=0}else if(typeof b=="function"){d=b;b=0}a=a||0;b=b||0;e(document).delegate("*","keydown.yoxview",function(f){if(g&&g.isOpen){var i=g[gb[fb[f.keyCode]]];if(i){f.preventDefault();i.apply(g)}}});Z(R[a]);!j&&m!=0&&Aa();this.selectImage(b);t.stop().css({opacity:1}).fadeIn("slow",function(){t.css("opacity","")});c.cacheImagesInBackground&&ga(b);if(d)va=d;return false};this.selectImage=function(a){g.currentImage=y[a];z=a;s(true);C.blur();W.css({"z-index":"1",width:u.width,height:u.height});O.css({display:"none",
"z-index":"2"});ua=true;j.css({width:u.width,height:u.height,top:u.top,left:u.left});this.select(a)};this.refresh=function(){(ka=q)&&E();q||Ta();Xa(g.currentImage.media);ka&&qa()};this.select=function(a,b){if(typeof b==="number")b=undefined;if(!Y){if(a<0)a=m-1;else if(a==m)a=0;if(!q&&b){var d=b;d.css("opacity")==0&&d.stop().animate({opacity:0},c.buttonsFadeTime,w(d))}g.currentImage=y[a];z=a;q||Ta();Xa(g.currentImage.media);Fa();c.onSelect&&c.onSelect(a,y[a])}};this.prev=function(a){l.cacheDirectionForward=
false;this.select(z-1,V);q&&a!==true&&E()};this.next=function(a){l.cacheDirectionForward=true;this.select(z+1,ma);q&&a!==true&&E()};this.first=function(){c.disableNotifications||G("first");this.select(0);q&&E()};this.last=function(){c.disableNotifications||G("last");this.select(m-1);q&&E()};this.play=function(){if(m!=1){l.cacheDirectionForward=true;if(q){c.disableNotifications||G("pause");E()}else{c.disableNotifications||G("play");qa()}}};this.close=function(){this.closeHelp();s(false);Ia(u.width,
u.height,u.top,u.left,function(){g.isOpen=false});Ca();p&&fa(function(){X.html("")});v.animate({width:u.width,height:u.height},c.popupResizeTime,function(){v.css("opacity",1)});t.stop().fadeOut(1E3);q&&E();Wa();c.onClose&&c.onClose();e(document).undelegate("*","keydown.yoxview");Y=false};this.help=function(){if(this.isOpen)T.css("display")=="none"?T.css("display","block").stop().animate({opacity:0.8},c.buttonsFadeTime):this.closeHelp()};this.closeHelp=function(){T.css("display")!="none"&&T.stop().animate({opacity:0},
c.buttonsFadeTime,function(){T.css("display","none")})};this.clickBtn=function(a,b){b&&q&&E();a.call(this);return false};this.AddViews(x,c);e(window).bind("resize.yoxview",function(){D=Na();g.isOpen&&g.resize()});e(Ra).load(function(){e.extend(y[l.currentCacheImg].media,{width:this.width,height:this.height,loaded:true});Ea()}).error(function(){Ea()});this.startCache=function(){Z(this.firstViewWithImages);Fa();ga(0)};var v=O,ia=W;this.resize=function(){if(q){ka=true;E()}var a=Ua(B);v.css({width:"100%",
height:"100%"});Y=true;ja||S.css({top:Math.round((a.height-ta.height)/2)});Ia(a.width,a.height,a.top,a.left,function(){var b=j.width(),d=j.height();if(B.padding){b-=B.padding.horizontal;d-=B.padding.vertical}v.css({width:b+"px",height:d+"px"});Y=false;p&&pa();if(ka){qa();ka=false}})};e(La).load(function(){this.width==0?wa("Image error"):sa(e.extend({},g.currentImage.media,{width:this.width,height:this.height}))}).error(function(){wa("Image not found:<br /><span class='errorUrl'>"+this.src+"</span>")});
this.unload=function(){jQuery.each(R,function(a,b){e(b).undelegate("a","click.yoxview").removeData("yoxview").yoxthumbs("unload","yoxview")});e(document).undelegate("*","keydown.yoxview");e(window).unbind(".yoxview");if(j){t.remove();j=undefined}}};
